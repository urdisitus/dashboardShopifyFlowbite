<div class="container-fluid">
    <div class="row">
        <div class="col-md-12">
            <span><b style="font-size: 30px;">Eventos de Integración</b></span>
        </div>
        <div class="col-md-12">
            <div class="card">
                <div class="card-block">
                    <div class="table-responsive">
                        <div class="row">
                            <div class="col-sm-3 col-md-2">
                                <mat-form-field class="margin-left matFormField" floatLabel="always" appearance="outline">
                                    <mat-label>Código Único</mat-label>
                                    <input #inputCriteria matInput placeholder="Código Único">
                                </mat-form-field>
                            </div>
                            <div class="col-sm-3 col-md-2">
                                <mat-form-field class="margin-left matFormField" floatLabel="always" appearance="outline">
                                    <mat-label>Fecha Inicial</mat-label>
                                    <input matInput [matDatepicker]="startPicker" placeholder="Selecciona una fecha inicial" required [(ngModel)]="startDate" (dateChange)="changeStartDate($event)">
                                    <mat-datepicker-toggle matSuffix [for]="startPicker"></mat-datepicker-toggle>
                                    <mat-datepicker #startPicker></mat-datepicker>
                                </mat-form-field>
                            </div>
                            <div class="col-sm-3 col-md-2">
                                <mat-form-field class="margin-left matFormField" floatLabel="always" appearance="outline">
                                    <mat-label>Fecha Final</mat-label>
                                    <input matInput [matDatepicker]="endPicker" placeholder="Selecciona una fecha final" required [(ngModel)]="endDate" (dateChange)="changeEndDate($event)">
                                    <mat-datepicker-toggle matSuffix [for]="endPicker"></mat-datepicker-toggle>
                                    <mat-datepicker #endPicker></mat-datepicker>
                                </mat-form-field>
                            </div>
                            <div class="col-sm-4 col-md-4">
                                <div class="form-group">
                                    <div class="form-inline">
                                        <a (click)="loadBranchOffices()" class="btn btn-icon btn-flat btn-rounded icon-style" href="javascript:void(0);"><i class="ei-refresh-alt"></i></a>
                                        <a (click)="clearBranchOffices()" class="btn btn-icon btn-flat btn-rounded icon-style" href="javascript:void(0);"><i class="ei-eraser"></i></a>
                                        <a (click)="selectAllBranchOffices()" class="btn btn-icon btn-flat btn-rounded icon-style" href="javascript:void(0);"><i class="ei-checked-box"></i></a>
                                        <ng-select2 id="branchOffice" name="branchOffice" style="width: 250px; margin-right: 10px;" [width]="200" [(ngModel)]="branchOfficeSelected" [data]="branchOfficesData" [placeholder]="'Sucursal'" [options]="branchOfficesConfig">
                                        </ng-select2>
                                    </div>
                                </div>
                            </div>
                            <div class="col-sm-4 col-md-4">
                                <div class="form-group">
                                    <div class="form-inline">
                                        <a (click)="loadEvenIntTypes()" class="btn btn-icon btn-flat btn-rounded icon-style" href="javascript:void(0);"><i class="ei-refresh-alt"></i></a>
                                        <a (click)="loadEvenIntTypes()" class="btn btn-icon btn-flat btn-rounded icon-style" href="javascript:void(0);"><i class="ei-eraser"></i></a>
                                        <a (click)="selectAllEventIntTypes()" class="btn btn-icon btn-flat btn-rounded icon-style" href="javascript:void(0);"><i class="ei-checked-box"></i></a>
                                        <ng-select2 id="eventIntType" name="eventIntType" style="width: 250px; margin-right: 10px;" [width]="200" [(ngModel)]="eventIntTypesSelected" [data]="eventIntTypesData" [placeholder]="'Tipo'" [options]="eventIntTypesConfig">
                                        </ng-select2>
                                    </div>
                                </div>
                            </div>
                            <div class="col-sm-4 col-md-4">
                                <div class="form-group">
                                    <div class="form-inline">
                                        <a (click)="loadEvenIntStatus()" class="btn btn-icon btn-flat btn-rounded icon-style" href="javascript:void(0);"><i class="ei-refresh-alt"></i></a>
                                        <a (click)="loadEvenIntStatus()" class="btn btn-icon btn-flat btn-rounded icon-style" href="javascript:void(0);"><i class="ei-eraser"></i></a>
                                        <a (click)="selectAllEventIntStatus()" class="btn btn-icon btn-flat btn-rounded icon-style" href="javascript:void(0);"><i class="ei-checked-box"></i></a>
                                        <ng-select2 id="eventIntStatus" name="eventIntStatus" style="width: 250px; margin-right: 10px;" [width]="200" [(ngModel)]="eventIntStatusSelected" [data]="eventIntStatusData" [placeholder]="'Estado'" [options]="eventIntStatusConfig">
                                        </ng-select2>
                                    </div>
                                </div>
                            </div>
                        </div>
                        &nbsp;&nbsp;
                        <div class="pull-right">
                            <button class="btn btn-success margin-left" (click)="search();"> Buscar Eventos </button>
                        </div>
                        &nbsp;&nbsp;
                        <div class="row">
                            <div class="col-sm-12">
                                <button class="btn btn-primary margin-left" (click)="resetearSeleccionados()"> Resetear Seleccionados</button>
                            </div>
                        </div>
                        &nbsp;&nbsp;
                        <table mat-table [dataSource]="_dataSource" matSort style="width:100%">
                            <!-- Position Column -->
                            <ng-container matColumnDef="check">
                                <th mat-header-cell *matHeaderCellDef>
                                    <input type="checkbox" [checked]="isAllCheckBoxChecked()" (change)="checkAllCheckBox($event)"></th>
                                <td mat-cell *matCellDef="let element">
                                    <input type="checkbox" value="{{element.id}}" [(ngModel)]="element.bSelected">
                                </td>
                            </ng-container>
                            <!-- Position Column -->
                            <ng-container matColumnDef="event">
                                <th mat-header-cell *matHeaderCellDef> Acciones </th>
                                <td mat-cell *matCellDef="let element">
                                    <button mat-button [matMenuTriggerFor]="menu"> ... </button>
                                    <mat-menu #menu="matMenu">
                                        <button mat-menu-item (click)="ver(element.id);">Ver</button>
                                        <button mat-menu-item (click)="resetear(element.id);">Reenviar</button>
                                    </mat-menu>
                                </td>
                            </ng-container>
                            <!-- Position Column -->
                            <ng-container matColumnDef="keyBodega">
                                <th mat-header-cell *matHeaderCellDef> Bodega </th>
                                <td mat-cell *matCellDef="let element"> {{element.keyBodega}} </td>
                            </ng-container>
                            <!-- Position Column -->
                            <ng-container matColumnDef="keySource">
                                <th mat-header-cell *matHeaderCellDef> Origen </th>
                                <td mat-cell *matCellDef="let element"> {{element.keySource}} </td>
                            </ng-container>
                            <!-- Position Column -->
                            <ng-container matColumnDef="codigoUnico">
                                <th mat-header-cell *matHeaderCellDef> Código Único </th>
                                <td mat-cell *matCellDef="let element"> {{element.codigoUnico}} </td>
                            </ng-container>
                            <!-- Position Column -->
                            <ng-container matColumnDef="tipoEventoIntegracion">
                                <th mat-header-cell *matHeaderCellDef> Tipo </th>
                                <td mat-cell *matCellDef="let element"> {{element.tipoEventoIntegracion}} </td>
                            </ng-container>
                            <!-- Position Column -->
                            <ng-container matColumnDef="fechaUltimoEnvio">
                                <th mat-header-cell *matHeaderCellDef> Último Envío </th>
                                <td mat-cell *matCellDef="let element"> {{element.fechaUltimoEnvio | date:'dd/MM/yyyy HH:mm:ss.SSS'}} </td>
                            </ng-container>
                            <!-- Position Column -->
                            <ng-container matColumnDef="estadoDesc">
                                <th mat-header-cell *matHeaderCellDef> Estado </th>
                                <td mat-cell *matCellDef="let element">
                                    <span [ngClass]="{'label': true,'label-danger': element.estado == 2, 'label-primary': element.estado == 1}">
                                    {{element.estadoDesc}}                                    
                                  </span>
                                </td>
                            </ng-container>
                            <!-- Position Column -->
                            <ng-container matColumnDef="fechaCreacion">
                                <th mat-header-cell *matHeaderCellDef> Fecha Creación </th>
                                <td mat-cell *matCellDef="let element"> {{element.fechaCreacion | date:'dd/MM/yyyy HH:mm:ss.SSS'}} </td>
                            </ng-container>

                            <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
                            <tr mat-row class="post-void" [ngClass]="{'error': row.estado == 2}" *matRowDef="let row; columns: displayedColumns;"></tr>
                        </table>
                        <mat-paginator [length]="_dataSource?.resultPage?.totalFiltered" [pageSize]="10" [pageSizeOptions]="[5, 10, 20, 50, 100]" showFirstLastButtons></mat-paginator>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>